{"version":3,"sources":["components/Panel/Panel.js","components/Join/Join.js","components/Map/Map.js","components/Chat/Message/Message.js","components/Chat/Input/Input.js","components/Chat/Chat.js","components/FlightsInfo/FlightInfo/FlightInfo.js","components/FlightsInfo/FlightsInfo.js","App.js","index.js"],"names":["socket","Join","useState","name","setName","className","placeholder","type","onChange","event","target","value","to","Map","flights","positions","colors","Object","keys","length","id","MapContainer","center","zoom","scrollWheelZoom","TileLayer","attribution","url","map","f","i","Polyline","color","Math","floor","random","dashArray","origin","destination","key","index","Marker","position","code","Tooltip","direction","opacity","offset","Message","message","date","Date","getDate","getMonth","getHours","getMinutes","Input","setMessage","sendMessage","onClick","Chat","messages","m","FlightInfo","flight","airline","passengers","p","age","FlightsInfo","updateFlights","Panel","location","setFlights","setMessages","setPositions","useEffect","queryString","parse","search","io","path","emit","on","newPosition","prevPositions","newDict","aux","Array","updatePositions","App","exact","component","ReactDOM","render","document","querySelector"],"mappings":"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","file":"static/js/main.c9fa5050.chunk.js","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport queryString from 'query-string';\nimport {io} from 'socket.io-client';\n\nimport './Panel.css';\n\nimport Map from '../Map/Map'\nimport Chat from '../Chat/Chat';\nimport FlightsInfo from '../FlightsInfo/FlightsInfo'\n\nlet socket;\n\nconst Panel = ({ location }) => {\n    const [name, setName] = useState('')\n    const [flights, setFlights] = useState([])\n    const [messages, setMessages] = useState([])\n    const [message, setMessage] = useState('')\n    const [positions, setPositions] = useState({})\n    \n    // function getFlightIndex(code){\n    //     for (let i=0; i<flights.length, i++;){\n    //         if (flights[i].code == code){\n    //             return i\n    //         }\n    //     }\n    // }\n\n    const ENDPOINT = 'wss://tarea-3-websocket.2021-1.tallerdeintegracion.cl';\n    const path = '/flights';\n\n    // function addNewPosition(pos, code, newPosition){\n    //     let aux = [...pos[code], newPosition.position];\n    //     let res = {...pos, [code]: aux}\n    //     console.log(\"before\", pos)\n    //     console.log(\"RES, added\", code, res)\n    //     return res\n    // }\n\n    function updatePositions(newPosition){\n        let code = newPosition.code;\n        let position = newPosition.position;\n        setPositions((prevPositions) => {\n            let newDict = {...prevPositions}\n            if (!(code in prevPositions)){\n                var aux = new Array();\n                aux[0] = position;\n    \n                newDict[code] = aux;\n                return newDict\n            } else {\n                let aux = [...prevPositions[code], position]\n                newDict[code] = aux;\n                return newDict\n            }\n        })\n        \n    }\n\n    useEffect(() => {\n        const {name} = queryString.parse(location.search);\n\n        socket = io(ENDPOINT, {\n            path:path\n        });\n\n        setName(name);\n        \n        socket.emit('FLIGHTS')\n        \n        // Recieve\n        socket.on('POSITION', newPosition => {\n            updatePositions(newPosition)\n        })\n\n\n        socket.on('FLIGHTS', flights => {\n            setFlights(flights);\n\n        })\n\n        socket.on('CHAT', message => {\n            setMessages(messages => [...messages, message]);\n        })\n\n    }, [])\n\n    const sendMessage = () => {\n        if(message) {\n          socket.emit('CHAT', {name: name, message: message}, () => setMessage(''));\n        }\n      }\n\n    const updateFlights = () => {\n        socket.emit('FLIGHTS')\n    }\n\n    return (                \n        <div className=\"outerContainer\">\n            <h1>Panel de control</h1>\n            <div className=\"columnsContainer\">\n                <div className=\"firstColumn\">\n                    <h3>Mapa</h3>\n                    < Map flights={flights} positions={positions}/>\n                </div>\n                <div className=\"secondColumn\">\n                    <h3>Chat</h3>\n                    <Chat messages={messages} setMessage={setMessage} sendMessage={sendMessage} message={message}/>\n                </div>\n            </div>\n            <div className=\"flightsContainer\">\n                <h3>Informaci√≥n de vuelos</h3>\n                <FlightsInfo flights={flights} updateFlights={updateFlights}/>\n            </div>\n        </div>\n\n\n\n    )\n}\n\nexport default Panel;","import React, { useState } from 'react';\nimport { Link } from 'react-router-dom';\n\nimport './Join.css';\n\nconst Join = () => {\n    const [name, setName] = useState('')\n\n    return (\n        <div className=\"joinOuterContainer\">\n            <h2>Login panel de control de vuelos</h2>\n            <div><input className=\"nameInput\" placeholder=\"Escribe tu nombre...\" type=\"text\" onChange={(event) => setName(event.target.value)}/></div>\n            <Link to={`/chat?name=${name}`}>\n                <button className=\"submitButton\" type='submit'>Entrar</button>\n            </Link>\n        </div>\n    )\n}\n\nexport default Join;","import React from 'react';\nimport './Map.css';\nimport { MapContainer, TileLayer, Polyline, Marker, Tooltip } from 'react-leaflet'\n\n\n\n\nconst Map = ({flights, positions} ) => {\n\n    const center = [-33.53, -69.48]\n    const colors = [\"red\", \"blue\", \"green\", \"yellow\", \"orange\", \"purple\", \"brown\"]\n\n    const getRandomColor = () => {\n        return colors[Math.floor(Math.random() * colors.length)]\n    }\n\n    if ((flights) && (Object.keys(positions).length >= flights.length)){\n        return (\n            <div id=\"mapOuterContainer\">\n                <MapContainer center={center} zoom={5} scrollWheelZoom={false}>\n                    <TileLayer\n                        attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n                        url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n                    />\n    \n                    {flights.map((f, i) => <Polyline key={i} color={getRandomColor()} dashArray='5, 5' positions={[f.origin, f.destination]} />)}\n                    {\n                        Object.keys(positions).map((key, index) => ( \n                        <Polyline key={index} color=\"white\" positions={positions[key]} /> \n                        ))\n                    }\n                    \n                    {\n                    flights.map((f, i) =>\n                        (<Marker key={i} position={positions[f.code][positions[f.code].length - 1]} >\n                            <Tooltip direction=\"top\" opacity={1} offset={[-15, -5]}>\n                                {f.code}\n                            </Tooltip>\n                        </Marker>)\n                        )\n                    }\n                    \n                </MapContainer>\n            </div>\n        );\n    } else {\n        return <h4>Cargando mapa...</h4>\n    }\n\n}\n\nexport default Map;","import React from 'react';\n\nimport './Message.css';\n\n\nconst Message = ({ message }) => {\n\n  var date = new Date(message.date)\n  \n  return (\n    (\n        <div className=\"messageOuterContainer\">\n          <div className=\"messageInfo\">\n            <p className=\"nameParagraph\">{message.name}</p> <p className=\"dateParagraph\">, {date.getDate()}/{date.getMonth()}, {date.getHours()}:{date.getMinutes()}</p>\n          </div>\n          <div className=\"textContainer\">\n            <p className=\"messageParagraph\">{message.message}</p>\n          </div>\n        </div>\n        )\n  );\n}\n\nexport default Message;","import React from 'react';\n\nimport './Input.css';\n\nconst Input = ({ setMessage, sendMessage, message }) => {\n\n\n  return (\n    <div className=\"inputOuterContainer\">\n        <input\n        className=\"input\"\n        type=\"text\"\n        placeholder=\"Escribe un mensaje...\"\n        value={message}\n        onChange={({ target: { value } }) => setMessage(value)}\n        />\n        <button className=\"sendButton\" onClick={() => sendMessage()}>Enviar</button>\n    </div>\n  );\n}\n\nexport default Input;","import React from \"react\";\nimport ScrollToBottom from 'react-scroll-to-bottom';\n\nimport './Chat.css';\nimport Message from './Message/Message';\nimport Input from './Input/Input';\n\n\n\nconst Chat = ({ messages, setMessage, sendMessage, message }) => {\n\n  return (\n    <div className=\"chatOuterContainer\">\n        <ScrollToBottom className=\"messages\">\n            {messages.map((m, i) => <div key={i}><Message message={m} /></div>)}\n        </ScrollToBottom>\n        <div className=\"input\">\n            <Input setMessage={setMessage} sendMessage={sendMessage} message={message} />\n        </div>\n    </div>\n  );\n}\n\nexport default Chat;","import React from 'react';\n\nimport './FlightInfo.css';\n\nconst FlightInfo = ({ flight }) => {\n\n  return (\n    (\n        <div className=\"flightOuterContainer\">\n            <p><b>{flight.airline} - {flight.code}</b></p>\n            <p>Pasajeros:</p>\n            <ul className=\"passengers\">\n                {flight.passengers.map((p, i) => <li key={i}> {p.name} (age {p.age}) </li>)}\n            </ul>\n        </div>\n        )\n  );\n}\n\nexport default FlightInfo;","import React from \"react\";\n\nimport './FlightsInfo.css';\nimport FlightInfo from './FlightInfo/FlightInfo';\n\nconst FlightsInfo = ({ flights, updateFlights }) => {\n\n  return (\n    <div className=\"flightsInfoOuterContainer\">\n        <button className=\"updateFlightsButton\" onClick={() => updateFlights()}>Recargar<br/>vuelos</button>\n        <div className=\"flights\">\n            {flights.map((f, i) => <FlightInfo key={i} flight={f} />)}\n        </div>\n    </div>\n\n  );\n}\n\nexport default FlightsInfo;","import React from 'react';\n\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\n\nimport Join from './components/Join/Join'\nimport Chat from './components/Panel/Panel'\n\nconst App = () => (\n\n    <Router>\n        <Route path=\"/\" exact component={Join}></Route>\n        <Route path=\"/chat\" component={Chat}></Route>\n    </Router>\n);\n\nexport default App;","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport App from './App';\n\nReactDOM.render(<App />, document.querySelector('#root'));\n"],"sourceRoot":""}